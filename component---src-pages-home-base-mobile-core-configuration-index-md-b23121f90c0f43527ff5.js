"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[2636,9164],{20787:function(e,a,n){n.r(a),n.d(a,{_frontmatter:function(){return d},default:function(){return u}});var t,i=n(87462),o=n(63366),r=(n(15007),n(64983)),l=n(91515),p=(n(62814),["components"]),d={},s=(t="InlineAlert",function(e){return console.warn("Component "+t+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",e)}),m={_frontmatter:d},c=l.Z;function u(e){var a=e.components,n=(0,o.Z)(e,p);return(0,r.mdx)(c,(0,i.Z)({},m,n,{components:a,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"configuration"},"Configuration"),(0,r.mdx)("p",null,"The Configuration extension is built into the Mobile Core extension. It provides several different APIs for you to setup the configuration either remotely in the Data Collection UI or locally."),(0,r.mdx)("h2",{id:"how-configuration-works"},"How Configuration Works"),(0,r.mdx)("p",null,"The Configuration extension manages two types of configuration values: ",(0,r.mdx)("strong",{parentName:"p"},"base configuration")," and ",(0,r.mdx)("strong",{parentName:"p"},"programmatic configuration"),". The final configuration is created by merging the programmatic configuration over the base configuration and then resolving ",(0,r.mdx)("a",{parentName:"p",href:"#environment-aware-configuration-properties"},"environment-aware properties"),". The Configuration extension then publishes the final configuration for use by all other extensions."),(0,r.mdx)("h3",{id:"base-configuration"},"Base Configuration:"),(0,r.mdx)("p",null,"The base configuration is loaded when the app launches, either from the ",(0,r.mdx)("a",{parentName:"p",href:"./api-reference.md#configurewithappid"},"cache")," or a ",(0,r.mdx)("a",{parentName:"p",href:"#using-a-bundled-file-configuration-for-first-launch-scenarios"},"bundled configuraton"),", if available. It can also be updated at any time using the following APIs:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"./api-reference.md#configurewithappid"},"configureWithAppID")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"./api-reference.md#configurewithfileinpath"},"configureWithFilePath")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"./api-reference.md#configurewithfileinassets"},"configureWithFileInAssets"))),(0,r.mdx)("h3",{id:"programmatic-configuration"},"Programmatic Configuration:"),(0,r.mdx)("p",null,"Programmatic configuration consists of overrides applied on top of the base configuration. This is persisted separately and managed through the following APIs:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"./api-reference.md#updateconfiguration"},"updateConfiguration")),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("a",{parentName:"li",href:"./api-reference.md#clearupdatedconfiguration"},"clearUpdatedConfiguration"))),(0,r.mdx)("p",null,"This is how the Configuration extension handles the following scenarios."),(0,r.mdx)("h3",{id:"app-launch"},"App Launch:"),(0,r.mdx)("p",null,"1) On app launch, the extension loads the base configuration as follows:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"First, the extension checks for and loads a cached configuration if available. This is typically cached from previous app launches. Refer ",(0,r.mdx)("a",{parentName:"li",href:"./api-reference.md#configurewithappid"},"configureWithAppID"),"."),(0,r.mdx)("li",{parentName:"ul"},"If no cached configuration is found, it looks for a ",(0,r.mdx)("a",{parentName:"li",href:"#using-a-bundled-file-configuration-for-first-launch-scenarios"},"bundled configuration"),".")),(0,r.mdx)("p",null,"2) If no base configuration is found, it will not publish a configuration and will wait for configuration APIs to be called by the app. This will cause the SDK to hold event processing."),(0,r.mdx)("p",null,"3) If a base configuration is loaded, it will publish the final configuration by merging it with any persisted programmatic configuration and resolving environment-aware properties."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"354px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"130.3125%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/aep-mobile-sdkdocs/static/e295873b141f7750ca83b61ec43bcec6/5530d/app-launch.webp 320w","/aep-mobile-sdkdocs/static/e295873b141f7750ca83b61ec43bcec6/7e454/app-launch.webp 354w"],sizes:"(max-width: 354px) 100vw, 354px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/aep-mobile-sdkdocs/static/e295873b141f7750ca83b61ec43bcec6/dd4a7/app-launch.png 320w","/aep-mobile-sdkdocs/static/e295873b141f7750ca83b61ec43bcec6/16bd5/app-launch.png 354w"],sizes:"(max-width: 354px) 100vw, 354px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/aep-mobile-sdkdocs/static/e295873b141f7750ca83b61ec43bcec6/16bd5/app-launch.png",alt:"Initial configuration after App Launch",title:"Initial configuration after App Launch",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("h3",{id:"configuration-apis"},"Configuration APIs:"),(0,r.mdx)("p",null,"The extension updates either the base configuration or the programmatic configuration, depending on the corresponding API call. Once the update is processed, it publishes the final configuration by merging programmatic configuration over base configuration and resolving environment-aware properties."),(0,r.mdx)("p",null,(0,r.mdx)("span",{parentName:"p",className:"gatsby-resp-image-wrapper",style:{position:"relative",display:"block",marginLeft:"auto",marginRight:"auto",maxWidth:"710px"}},"\n      ",(0,r.mdx)("span",{parentName:"span",className:"gatsby-resp-image-background-image",style:{paddingBottom:"57.8125%",position:"relative",bottom:"0",left:"0",display:"block",transition:"opacity 0.5s 0.5s",pointerEvents:"none"}}),"\n  ",(0,r.mdx)("picture",{parentName:"span"},"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/5530d/api-call.webp 320w","/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/0c8fb/api-call.webp 640w","/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/3267d/api-call.webp 710w"],sizes:"(max-width: 710px) 100vw, 710px",type:"image/webp"}),"\n          ",(0,r.mdx)("source",{parentName:"picture",srcSet:["/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/dd4a7/api-call.png 320w","/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/0f09e/api-call.png 640w","/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/911ab/api-call.png 710w"],sizes:"(max-width: 710px) 100vw, 710px",type:"image/png"}),"\n          ",(0,r.mdx)("img",{parentName:"picture",className:"gatsby-resp-image-image",src:"/aep-mobile-sdkdocs/static/9957df7789376eff7b2c8c636e1f2e15/911ab/api-call.png",alt:"Updated configuration after API Call",title:"Updated configuration after API Call",loading:"lazy",style:{width:"100%",height:"100%",margin:"0",verticalAlign:"middle",position:"absolute",opacity:"0",transition:"opacity 0.5s",color:"inherit",boxShadow:"inset 0px 0px 0px 400px none",top:"0",left:"0"}}),"\n        "),"\n    ")),(0,r.mdx)("h2",{id:"using-a-bundled-file-configuration-for-first-launch-scenarios"},"Using a bundled file configuration for first launch scenarios"),(0,r.mdx)("p",null,"When configuring the SDK using the ",(0,r.mdx)("a",{parentName:"p",href:"./api-reference.md#configurewithappid"},"Configure with App ID")," approach, the SDK downloads the Adobe hosted configuration and caches it for future launches. On subsequent app launches, the SDK uses this cached configuration during initialization and will only re-download it if any changes are detected."),(0,r.mdx)("p",null,"However, on the initial launch after app installation, the SDK does not have a cached configuration available. In this case, SDK processing is deferred until the configuration is successfully retrieved from the remote server. This introduces a timing gap during which essential SDK features depend on a network connection to fetch the configuration data."),(0,r.mdx)("p",null,"Applications which need to get data from the SDK early in the application lifecycle should use a bundled file configuration. This will allow the SDK to properly process events before a remote configuration is downloaded, using the bundled configuration. Without a bundled configuration, events triggered early after app launch will wait for the remote configuration to download and may not function as expected."),(0,r.mdx)("p",null,"To use a bundled configuration, follow the steps below:"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},"Download your JSON configuration file from the following URL: ",(0,r.mdx)("a",{parentName:"li",href:"https://assets.adobedtm.com/PASTE-ENVIRONMENT-ID.json"},"https://assets.adobedtm.com/PASTE-ENVIRONMENT-ID.json"),", replacing PASTE-ENVIRONMENT-ID with your mobile property environment ID."),(0,r.mdx)("li",{parentName:"ol"},"Rename the JSON file to “ADBMobileConfig.json”."),(0,r.mdx)("li",{parentName:"ol"},"iOS: Place the file anywhere that it is accessible in your app bundle.\nAndroid: Place the file in the assets folder.")),(0,r.mdx)(s,{variant:"info",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"Please note that the configuration that is downloaded by using the ",(0,r.mdx)("a",{parentName:"p",href:"./api-reference.md#configuration-api-reference"},"Configure with App ID")," approach, will overwrite the bundled configuration once it is downloaded, allowing you to always keep a more up-to-date configuration remotely, without needing an app update."),(0,r.mdx)("h2",{id:"environment-aware-configuration-properties"},"Environment-aware configuration properties"),(0,r.mdx)("p",null,"Some extension developers might use different configuration values based on their environment, and the generated configuration might have several entries for the same property. For example, the Adobe Campaign Standard extension has different endpoints for development, staging, and production servers. Here is an example of a raw configuration that supports multiple build environments:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},'{\n  "myExtension.server": "mydomain.com",\n  "__dev__myExtension.server": "mydomain.dev.com",\n  "__stage__myExtension.server": "mydomain.stage.com"\n}\n')),(0,r.mdx)(s,{variant:"success",slots:"text",mdxType:"InlineAlert"}),(0,r.mdx)("p",null,"Each time a remote configuration is generated in the Data Collection UI, a ",(0,r.mdx)("inlineCode",{parentName:"p"},"build.environment")," value is set. This value is based on the environment that you are publishing. When the remote configuration is downloaded, the Configuration extension considers the value in ",(0,r.mdx)("inlineCode",{parentName:"p"},"build.environment")," and provides ",(0,r.mdx)("strong",{parentName:"p"},"only")," the non-prefixed version for the current environment in the shared state."),(0,r.mdx)("p",null,"Here is a modification of the previous example, which now includes ",(0,r.mdx)("inlineCode",{parentName:"p"},"build.environment"),":"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},'{\n  "build.environment": "dev",\n  "myExtension.server": "mydomain.com",\n  "__dev__myExtension.server": "mydomain.dev.com",\n  "__stage__myExtension.server": "mydomain.stage.com"\n}\n')),(0,r.mdx)("p",null,"Here is the resulting shared state from the Configuration extension:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},'{\n  "build.environment": "dev",\n  "myExtension.server": "mydomain.dev.com"  \n}\n')),(0,r.mdx)("h2",{id:"sample-configuration"},"Sample configuration"),(0,r.mdx)("p",null,"Here's a sample JSON file for the SDK:"),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-javascript"},'{\n    "experienceCloud.org": "3CE342C75100435B0A490D4C@AdobeOrg",  \n    "target.clientCode": "yourclientcode",  \n    "target.timeout": 5,  \n    "audience.server": "omniture.demdex.net",  \n    "audience.timeout": 5,  \n    "analytics.rsids": "mobilersidsample",  \n    "analytics.server": "obumobile1.sc.omtrdc.net",  \n    "analytics.aamForwardingEnabled": false,  \n    "analytics.offlineEnabled": true,  \n    "analytics.batchLimit": 0,  \n    "analytics.backdatePreviousSessionInfo": false,\n    "global.privacy": "optedin",  \n    "lifecycle.sessionTimeout": 300,  \n    "rules.url": "https://link.to.rules/test.zip"\n}\n')))}u.isMDXComponent=!0},62814:function(e,a,n){n.r(a),n.d(a,{_frontmatter:function(){return d},default:function(){return u}});var t,i=n(87462),o=n(63366),r=(n(15007),n(64983)),l=n(91515),p=["components"],d={},s=(t="Variant",function(e){return console.warn("Component "+t+" was not imported, exported, or provided by MDXProvider as global scope"),(0,r.mdx)("div",e)}),m={_frontmatter:d},c=l.Z;function u(e){var a=e.components,n=(0,o.Z)(e,p);return(0,r.mdx)(c,(0,i.Z)({},m,n,{components:a,mdxType:"MDXLayout"}),(0,r.mdx)(s,{platform:"android",task:"configure",repeat:"5",mdxType:"Variant"}),(0,r.mdx)("h4",{id:"java"},"Java"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-java"},"public static void configureWithAppID(@NonNull final String appId);\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-java"},'MobileCore.configureWithAppId("1423ae38-8385-8963-8693-28375403491d");\n')),(0,r.mdx)(s,{platform:"ios",task:"configure",repeat:"11",mdxType:"Variant"}),(0,r.mdx)("h4",{id:"swift"},"Swift"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-swift"},"static func configureWith(appId: String)\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-swift"},'MobileCore.configureWith(appId: "1423ae38-8385-8963-8693-28375403491d")\n')),(0,r.mdx)("h4",{id:"objective-c"},"Objective-C"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-objectivec"},"+ (void) configureWithAppId: (NSString* appId);\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-objectivec"},'[AEPMobileCore configureWithAppId: @"1423ae38-8385-8963-8693-28375403491d"];\n')),(0,r.mdx)("p",null,"Alternatively, you can also place the environment ID in your iOS project's ",(0,r.mdx)("em",{parentName:"p"},"Info.plist")," with the ",(0,r.mdx)("inlineCode",{parentName:"p"},"ADBMobileAppID")," key. When the SDK is initialized, the environment ID is automatically read from the ",(0,r.mdx)("em",{parentName:"p"},"Info.plist")," file and the associated configuration."),(0,r.mdx)(s,{platform:"android",task:"update",repeat:"5",mdxType:"Variant"}),(0,r.mdx)("h4",{id:"java-1"},"Java"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-java"},"public static void updateConfiguration(@NonNull final Map<String, Object> configMap);\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-java"},'HashMap<String, Object> data = new HashMap<String, Object>();\ndata.put("global.privacy", "optedout");\nMobileCore.updateConfiguration(data);\n')),(0,r.mdx)(s,{platform:"ios",task:"update",repeat:"10",mdxType:"Variant"}),(0,r.mdx)("h4",{id:"swift-1"},"Swift"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-swift"},"@objc(updateConfiguration:)\nstatic func updateConfigurationWith(configDict: [String: Any])\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-swift"},'let updatedConfig = ["global.privacy":"optedout"]\nMobileCore.updateConfigurationWith(configDict: updatedConfig)\n')),(0,r.mdx)("h4",{id:"objective-c-1"},"Objective-C"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-objectivec"},"+ (void) updateConfiguration: (NSDictionary* __nullable) config;\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-objectivec"},'NSDictionary *updatedConfig = @{@"global.privacy":@"optedout"};\n[AEPMobileCore updateConfiguration:updatedConfig];\n')),(0,r.mdx)(s,{platform:"android",task:"bundle",repeat:"5",mdxType:"Variant"}),(0,r.mdx)("h4",{id:"java-2"},"Java"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-java"},"public static void configureWithFileInPath(@NonNull final String filePath)\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-java"},'// Case 1: to use ADBMobileConfig.json in the assets folder\n// No code is needed\n\n// Case 2: to use a config json from a absolute path:\nMobileCore.configureWithFileInPath("absolute/path/to/exampleJSONfile.json");\n\n// Case 3: to use a config json in Assets folder\nMobileCore.configureWithFileInAssets("exampleJSONfile.json");\n')),(0,r.mdx)(s,{platform:"ios",task:"bundle",repeat:"10",mdxType:"Variant"}),(0,r.mdx)("h4",{id:"swift-2"},"Swift"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-swift"},"static func configureWith(filePath: String)\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-swift"},'let filePath = Bundle.main.path(forResource: "ExampleJSONFile", ofType: "json")\nif let filePath = filePath {\n    MobileCore.configureWith(filePath: filePath)\n}\n')),(0,r.mdx)("h4",{id:"objective-c-2"},"Objective-C"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Syntax")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-objectivec"},"+ (void) configureWithFilePath: (NSString* __nullable) filepath;\n")),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Example")),(0,r.mdx)("pre",null,(0,r.mdx)("code",{parentName:"pre",className:"language-objectivec"},'NSString *filePath = [[NSBundle mainBundle] pathForResource:@"ExampleJSONFile" ofType:@"json"];\n[AEPMobileCore configureWithFilePath: filePath];\n')))}u.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-home-base-mobile-core-configuration-index-md-b23121f90c0f43527ff5.js.map