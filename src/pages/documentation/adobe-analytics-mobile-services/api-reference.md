import Tabs from './tabs/api-reference.md'

# Mobile Services API reference

## extensionVersion

The `extensionVersion()` API returns the version of the Mobile Services extension that is registered with the Mobile Core extension.

<TabsBlock orientation="horizontal" slots="heading, content" repeat="3"/>

Android

<Tabs query="platform=android&api=extension-version"/>

iOS (AEP 3.x)

<Tabs query="platform=ios-aep&api=extension-version"/>

iOS (ACP 2.x)

<Tabs query="platform=ios-acp&api=extension-version"/>

## processReferrer

You can use this API to process the referrer intent that was received from Android.

<InlineAlert variant="warning" slots="text"/>

This API is **only** available in Android.

#### Java

**Syntax**

```java
public static void processReferrer(final Context context, final Intent intent)
```

**Example**

```java
public  void onReceive(Context context, Intent intent) {
    MobileServices.processReferrer(context, intent);
}
```

## processGooglePlayInstallReferrerUrl

You can use this API to process the data you get from the Google Play Install Referrer APIs.

<InlineAlert variant="warning" slots="text"/>

This API is **only** available on Android, starting in version `1.1.0`.

#### Java

**Syntax**

```java
public static void processGooglePlayInstallReferrerUrl(final Context context, final Intent intent)
```

**Example**

```java
void handleGooglePlayReferrer() {
    // Google recommends only calling this API the first time you need it:
    // https://developer.android.com/google/play/installreferrer/library#install-referrer

    // Store a boolean in SharedPreferences to ensure we only call it once.
    final SharedPreferences prefs = getSharedPreferences("acquisition", 0);
    if (prefs != null) {
        if (prefs.getBoolean("referrerHasBeenProcessed", false)) {
            return;
        }
    }

    final InstallReferrerClient referrerClient = InstallReferrerClient.newBuilder(getApplicationContext()).build();
    referrerClient.startConnection(new InstallReferrerStateListener() {
        private boolean complete = false;

        @Override
        public void onInstallReferrerSetupFinished(int responseCode) {
            switch (responseCode) {
                case InstallReferrerClient.InstallReferrerResponse.OK:
                    // connection is established
                    complete();
                    try {
                        final ReferrerDetails details = referrerClient.getInstallReferrer();                        

                        // pass the install referrer url to the SDK
                        MobileServices.processGooglePlayInstallReferrerUrl(details.getInstallReferrer());

                    } catch (final RemoteException ex) {
                        Log.w("Acquisition - RemoteException while retrieving referrer information (%s)", ex.getLocalizedMessage() == null ? "unknown" : ex.getLocalizedMessage());
                    } finally {
                        referrerClient.endConnection();
                    }
                    break;
                case InstallReferrerClient.InstallReferrerResponse.FEATURE_NOT_SUPPORTED:
                case InstallReferrerClient.InstallReferrerResponse.SERVICE_UNAVAILABLE:
                default:
                    // API not available in the Play Store app - nothing to do here
                    complete();
                    referrerClient.endConnection();
                    break;
            }
        }

        @Override
        public void onInstallReferrerServiceDisconnected() {
            if (!complete) {
                // something went wrong trying to get a connection, try again
                referrerClient.startConnection(this);
            }
        }

        void complete() {
            complete = true;
            SharedPreferences.Editor editor = getSharedPreferences("acquisition", 0).edit();
            editor.putBoolean("referrerHasBeenProcessed", true);
            editor.apply();
        }
    });
}
```

## trackAdobeDeepLink

You can use this API to track a deep link or a marketing link, as long as the link contains a key `a.deeplink.id` and a corresponding non-null and user generated value. The link can be created in the Adobe Mobile Services UI or be generated by another vendor.

<TabsBlock orientation="horizontal" slots="heading, content" repeat="3"/>

Android

<Tabs query="platform=android&api=track-adobe-deep-link"/>

iOS (AEP 3.x)

<Tabs query="platform=ios-aep&api=track-adobe-deep-link"/>

iOS (ACP 2.x)

<Tabs query="platform=ios-acp&api=track-adobe-deep-link"/>