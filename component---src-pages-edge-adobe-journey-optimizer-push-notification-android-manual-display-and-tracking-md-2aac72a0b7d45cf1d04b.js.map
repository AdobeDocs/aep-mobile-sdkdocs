{"version":3,"file":"component---src-pages-edge-adobe-journey-optimizer-push-notification-android-manual-display-and-tracking-md-2aac72a0b7d45cf1d04b.js","mappings":"2OAOsBA,E,wEADTC,EAAe,CAAC,EAKvBC,GAJgBF,EAIY,cAJJ,SAA6BG,GAEzD,OADAC,QAAQC,KAAK,aAAeL,EAAO,4EAC5B,eAASG,EAClB,GAEMG,EAAc,CAClBL,aAAAA,GAEIM,EAAYC,EAAAA,EACH,SAASC,EAAW,GAGhC,IAFDC,EAAU,EAAVA,WACGP,GAAK,YAER,OAAO,SAACI,GAAS,UAAKD,EAAiBH,EAAK,CAAEO,WAAYA,EAAYC,QAAQ,eAG5E,eACE,GAAM,oDAAkD,qDAE1D,4LAA6K,cAAGC,WAAW,IACvL,KAAQ,wCAAsC,kCACP,6GAC3C,eACE,GAAM,kBAAgB,mBAExB,mBAAG,cAAGA,WAAW,IACb,KAAQ,uDAAqD,kDACN,kBAC3D,eACE,GAAM,uBAAqB,wBAE7B,wHAAyG,cAAGA,WAAW,IACnH,KAAQ,2GAAyG,0BAClF,eAAe,uBAAYA,WAAW,KAAG,qBAAmC,oFAC/G,SAACV,EAAW,CAACW,QAAQ,OAAOC,MAAM,OAAOH,QAAQ,iBACjD,iOACA,qBAAK,iBAAMC,WAAW,MAClB,UAAa,iBAAe,giBAmBhC,eACE,GAAM,wCAAsC,yCAE9C,oBACE,eAAIA,WAAW,OACb,cAAGA,WAAW,MAAI,OAAQ,uBAAYA,WAAW,KAAG,qBAAmC,eAAe,uBAAYA,WAAW,KAAG,mCAAiD,qBAAqB,uBAAYA,WAAW,KAAG,wBAAsC,oCAAoC,uBAAYA,WAAW,KAAG,wBAAsC,oHAC1W,gBAAKA,WAAW,OAAK,iBAAMA,WAAW,MAClC,UAAa,iBAAe,gFAIlC,eAAIA,WAAW,OACb,cAAGA,WAAW,MAAI,YAAa,cAAGA,WAAW,IACzC,KAAQ,oDAAkD,eACtC,gGACxB,gBAAKA,WAAW,OAAK,iBAAMA,WAAW,MAClC,UAAa,iBAAe,iYAWlC,eAAIA,WAAW,OACb,cAAGA,WAAW,MAAI,8JAClB,gBAAKA,WAAW,OAAK,iBAAMA,WAAW,MAClC,UAAa,iBAAe,kVAOlC,eAAIA,WAAW,OACb,cAAGA,WAAW,MAAI,4EAGtB,+GACA,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,89CAiChC,eACE,GAAM,2CAAyC,4CAEjD,gHAAiG,uBAAYA,WAAW,KAAG,8BAA4C,0EACvK,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,oUAMhC,mBAAG,mBAAQA,WAAW,KAAG,yGACzB,sEAAuD,uBAAYA,WAAW,KAAG,UAAwB,+DACzG,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,iEAGhC,mBAAG,mBAAQA,WAAW,KAAG,sEACzB,6DAA8C,uBAAYA,WAAW,KAAG,8BAA4C,6CACpH,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,uEAGhC,mBAAG,mBAAQA,WAAW,KAAG,kGACzB,sEAAuD,uBAAYA,WAAW,KAAG,UAAwB,+DACzG,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,wEAGhC,6GACA,qBAAK,iBAAMA,WAAW,MAClB,UAAa,iBAAe,4iBAqBpC,CAEAH,EAAWM,gBAAiB,C","sources":["webpack://dev-site-documentation-template/./src/pages/edge/adobe-journey-optimizer/push-notification/android/manual-display-and-tracking.md"],"sourcesContent":["import * as React from 'react'\n  /* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsxRuntime classic */\n/* @jsx mdx */\nimport DefaultLayout from \"/home/runner/work/aep-mobile-sdkdocs/aep-mobile-sdkdocs/node_modules/@adobe/gatsby-theme-aio/src/components/MDXFilter/index.js\";\nexport const _frontmatter = {};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n  return <div {...props} />;\n};\nconst InlineAlert = makeShortcode(\"InlineAlert\");\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = DefaultLayout;\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n\n\n    <h1 {...{\n      \"id\": \"manual-display-and-tracking-of-push-notification\"\n    }}>{`Manual display and tracking of push notification`}</h1>\n    <p>{`This document describes how to manually build, display and track push notifications from Adobe Journey Optimizer using the AEPMessaging extension. You should use the `}<a parentName=\"p\" {...{\n        \"href\": \"./automatic-handling-and-tracking.md\"\n      }}>{`automatic display and tracking`}</a>{` method unless you have a specific requirement to manually build, display, and track push notifications.`}</p>\n    <h2 {...{\n      \"id\": \"pre-requisites\"\n    }}>{`Pre-requisites`}</h2>\n    <p><a parentName=\"p\" {...{\n        \"href\": \"../../../index.md#implement-extension-in-mobile-app\"\n      }}>{`Integrate and register the Messaging extension`}</a>{` in your app.`}</p>\n    <h2 {...{\n      \"id\": \"sync-the-push-token\"\n    }}>{`Sync the push token`}</h2>\n    <p>{`To retrieve the push token from Firebase Messaging Service, please follow the tutorial within the `}<a parentName=\"p\" {...{\n        \"href\": \"https://firebase.google.com/docs/cloud-messaging/android/client#retrieve-the-current-registration-token\"\n      }}>{`Firebase documentation`}</a>{`. Then use `}<inlineCode parentName=\"p\">{`setPushIdentifier`}</inlineCode>{` API to sync the device's push token with profile in Adobe Experience Platform.`}</p>\n    <InlineAlert variant=\"info\" slots=\"text\" mdxType=\"InlineAlert\" />\n    <p>{`Although this API is provided in Mobile Core, the use of this API is required and leveraged by the Adobe Journey Optimizer extension to sync provided push tokens with Adobe Experience Platform services.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`public class YourApp extends Application {\n\n    @Override\n    public void onCreate() {\n        super.onCreate();\n        FirebaseMessaging.getInstance().getToken().addOnCompleteListener(new OnCompleteListener<String>() {\n\n            @Override\n            public void onComplete(@NonNull Task<String> task) {\n                if (task.isSuccessful()) {\n                    String token = task.getResult();\n                    MobileCore.setPushIdentifier(token);\n                }       \n            }\n        });\n    }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"building-and-displaying-notification\"\n    }}>{`Building and displaying notification`}</h2>\n    <ol>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`In `}<inlineCode parentName=\"p\">{`onMessageReceived`}</inlineCode>{` method of `}<inlineCode parentName=\"p\">{`YourAppFirebaseMessagingService`}</inlineCode>{` class, create a `}<inlineCode parentName=\"p\">{`MessagingPushPayload`}</inlineCode>{` object from the remoteMessage. `}<inlineCode parentName=\"p\">{`MessagingPushPayload`}</inlineCode>{` will unpack the remoteMessage and provide APIs for getting attributes used for creating the push notification.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-java\"\n          }}>{`MessagingPushPayload payload = new MessagingPushPayload(remoteMessage);\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use the `}<a parentName=\"p\" {...{\n            \"href\": \"../enum-public-classes/messaging-push-payload.md\"\n          }}>{`Public APIs`}</a>{` of MessagingPushPayload to get the attributes required for creating the push notification.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-java\"\n          }}>{`// Following are a few examples of using the public APIs of MessagingPushPayload\nString title = payload.getTitle();\nString body = payload.getBody();\nint badgeCount = payload.getBadgeCount();\nint notificationPriority = payload.getNotificationPriority();\nString channelId = payload.getChannelId();\nString icon = payload.getIcon();\nString imageUrl = payload.getImageUrl();\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`The intent which is created while building the notification needs to be updated with necessary Adobe information to track push notification interactions.`}</p>\n        <pre parentName=\"li\"><code parentName=\"pre\" {...{\n            \"className\": \"language-java\"\n          }}>{`Messaging.addPushTrackingDetails(\n    final Intent intent, // intent which will be used when user interacts with the notification.\n    final String messageId, // message.id which represents the id of the push notification\n    final Map<String, String> data) // message.data which represents the data part of the remoteMessage.\n`}</code></pre>\n      </li>\n      <li parentName=\"ol\">\n        <p parentName=\"li\">{`Use NotificationManager to create and display the built notification.`}</p>\n      </li>\n    </ol>\n    <p>{`Here is a sample code for creating a notification channel and building the notification.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`public class YourAppFirebaseMessagingService extends FirebaseMessagingService {\n\n    @Override\n    public void onMessageReceived(@NonNull RemoteMessage remoteMessage) {\n        super.onMessageReceived(remoteMessage);\n        // Create a MessagingPushPayload object from the remoteMessage\n        MessagingPushPayload payload = new MessagingPushPayload(remoteMessage);\n\n        // Write your code for creating or using an existing notification channel.\n\n        // Creating an intent and attaching tracking details to it.\n        Intent intent = new Intent(this, MainActivity.class);\n        Messaging.addPushTrackingDetails(intent, remoteMessage.getMessageId(), remoteMessage.getData());\n        \n        // Write your code to create a pending intent\n        \n        // Create a notification builder \n        NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(this, CHANNEL_ID)\n                        .setSmallIcon(R.drawable.ic_launcher_foreground)\n                        .setContentTitle(payload.getTitle())\n                        .setContentText(payload.getBody())\n                        .setAutoCancel(true)\n                        .setContentIntent(pendingIntent);\n\n        // Write your code to add custom buttons to notification, if neccessary.\n\n        // Write your code to download and attach media to notification, if neccessary.\n\n        notificationManager.notify(notificationId, notificationBuilder.build());\n    }\n}\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"tracking-push-notification-interactions\"\n    }}>{`Tracking push notification interactions`}</h2>\n    <p>{`After the application is opened by the user by clicking on the push notification, use the `}<inlineCode parentName=\"p\">{`handleNotificationResponse`}</inlineCode>{` API to send the push notification interactions feedback to Platform.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`    Messaging.handleNotificationResponse(\n        final Intent intent, // Intent which contains information related to messageId and data\n        final boolean applicationOpened, //  whether application was opened or not\n        final String actionId) // actionId of the element which performed the custom action.\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Sending push notification interaction feedback when application is opened without any custom action`}</strong></p>\n    <p>{`Add the following code where you have access to `}<inlineCode parentName=\"p\">{`intent`}</inlineCode>{` after the user has interacted with the push notification:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`Messaging.handleNotificationResponse(intent, true, null);\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Sending feedback when application is opened with a custom action`}</strong></p>\n    <p>{`Similar to the example above, call the `}<inlineCode parentName=\"p\">{`handleNotificationResponse`}</inlineCode>{` API but this time with a custom action:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`Messaging.handleNotificationResponse(intent, true, <actionId>);\n`}</code></pre>\n    <p><strong parentName=\"p\">{`Sending feedback when application is not opened but a custom action is performed by the user`}</strong></p>\n    <p>{`Add the following code where you have access to `}<inlineCode parentName=\"p\">{`intent`}</inlineCode>{` after the user has interacted with the push notification:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`Messaging.handleNotificationResponse(intent, false, <actionId>);\n`}</code></pre>\n    <p>{`Here is a sample code for sending push notification interactions feedback to Platform.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-java\"\n      }}>{`\npublic class MainActivity extends AppCompatActivity {\n\n    @Override\n    protected void onCreate(Bundle savedInstanceState) {\n        super.onCreate(savedInstanceState);\n        setContentView(R.layout.activity_main);\n\n        final Intent intent = getIntent();\n\n        // use your unique way to determine isAppOpenFromPushInteraction\n        if (isAppOpenFromPushInteraction) {\n            // tracking application opened with no custom action\n            Messaging.handleNotificationResponse(intent, true, null);\n        }\n    }\n}\n`}</code></pre>\n\n    </MDXLayout>;\n}\n;\nMDXContent.isMDXComponent = true;\n      "],"names":["name","_frontmatter","InlineAlert","props","console","warn","layoutProps","MDXLayout","DefaultLayout","MDXContent","components","mdxType","parentName","variant","slots","isMDXComponent"],"sourceRoot":""}