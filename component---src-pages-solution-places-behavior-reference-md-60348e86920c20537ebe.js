"use strict";(self.webpackChunkdev_site_documentation_template=self.webpackChunkdev_site_documentation_template||[]).push([[2669],{45664:function(e,a,t){t.r(a),t.d(a,{_frontmatter:function(){return o},default:function(){return p}});var n=t(87462),s=t(63366),r=(t(15007),t(64983)),i=t(91515),l=["components"],o={},d={_frontmatter:o},m=i.Z;function p(e){var a=e.components,t=(0,s.Z)(e,l);return(0,r.mdx)(m,(0,n.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,r.mdx)("h1",{id:"places-behavior-reference"},"Places behavior reference"),(0,r.mdx)("p",null,"The Places extension provides three different point of interest (POI) states that can be interacted with using rules. This document explains general Places behavior, what states are available, and how states change through different scenarios."),(0,r.mdx)("h2",{id:"terms"},"Terms"),(0,r.mdx)("p",null,"For definitions of key terms, see ",(0,r.mdx)("a",{parentName:"p",href:"https://experienceleague.adobe.com/en/docs/places/using/home#terminology"},"Places Terminology"),"."),(0,r.mdx)("h4",{id:"library-rank"},"Library rank"),(0,r.mdx)("p",null,"A ",(0,r.mdx)("strong",{parentName:"p"},"library rank"),", also referred to as ",(0,r.mdx)("strong",{parentName:"p"},"weight"),", is the priority assigned to a library when multiple libraries are in use. A smaller rank value (for example, 1) indicates a higher priority, while a larger rank value (for example, 4) indicates a lower priority. This ranking is one of the factors used to determine which libraryâ€™s points of interest (POIs) take precedence when overlaps occur."),(0,r.mdx)("h4",{id:"membership-time-to-live"},"Membership time to live"),(0,r.mdx)("p",null,(0,r.mdx)("strong",{parentName:"p"},"Membership time to live")," specifies how long POI states (Current POI, Last Entered POI, Last Exited POI) remain valid. This duration applies globally to all POIs and has a default value of one hour. The duration is refreshed in the following cases:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"On every POI entry or exit event."),(0,r.mdx)("li",{parentName:"ul"},"When calling ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#getnearbypointsofinterest"},(0,r.mdx)("inlineCode",{parentName:"a"},"getNearbyPointsOfInterest")),".")),(0,r.mdx)("p",null,"To modify this value, use the ",(0,r.mdx)("inlineCode",{parentName:"p"},"places.membershipttl")," key. For additional details, see ",(0,r.mdx)("a",{parentName:"p",href:"/aep-mobile-sdkdocs/src/pages/solution/places/index.md#configuration-keys"},"Places configuration"),"."),(0,r.mdx)("h2",{id:"places-states"},"Places states"),(0,r.mdx)("p",null,"There are three primary Places states: Current POI, Last Entered POI, and Last Exited POI. These states are also stored in device persistence and carry across app sessions. In an Adobe Data Collection tags mobile property, rules can define Places conditions based on these states. Scenarios illustrating how these states change are provided in the ",(0,r.mdx)("a",{parentName:"p",href:"#scenarios"},"Scenarios")," section."),(0,r.mdx)("h3",{id:"current-poi"},"Current POI"),(0,r.mdx)("p",null,"When multiple POIs are simultaneously in the entered state, they are evaluated in the following order of precedence:"),(0,r.mdx)("ol",null,(0,r.mdx)("li",{parentName:"ol"},"Library rank: Lower rank values represent higher priority.  "),(0,r.mdx)("li",{parentName:"ol"},"Radius: The POI with the smaller radius is prioritized.  "),(0,r.mdx)("li",{parentName:"ol"},"Most recent entry signal or closest POI: The evaluation depends on the API used:  ",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},"For ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processregionevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processRegionEvent")),", ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofence"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofence")),", and ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofenceevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofenceEvent")),", the POI associated with the most recent entry signal takes priority.  "),(0,r.mdx)("li",{parentName:"ul"},"For ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#getnearbypointsofinterest"},(0,r.mdx)("inlineCode",{parentName:"a"},"getNearbyPointsOfInterest")),", the POI closest to the provided latitude and longitude takes priority.  ")))),(0,r.mdx)("h3",{id:"entered-state"},"Entered state"),(0,r.mdx)("p",null,"A POI is in the entered state when either:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"An entry signal is sent using the ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processregionevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processRegionEvent"))," API on iOS or the ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofence"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofence"))," and ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofenceevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofenceEvent"))," APIs on Android.  "),(0,r.mdx)("li",{parentName:"ul"},"The ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#getnearbypointsofinterest"},(0,r.mdx)("inlineCode",{parentName:"a"},"getNearbyPointsOfInterest"))," API is called, and the entered state flag is set for the POI in the response from the Places API.  ")),(0,r.mdx)("p",null,"POIs remain in the entered state across app sessions until one of the following occurs:"),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},"An exit signal is sent for the POI using the ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processregionevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processRegionEvent"))," API on iOS or the ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofence"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofence"))," and ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofenceevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofenceEvent"))," APIs on Android.  "),(0,r.mdx)("li",{parentName:"ul"},"The membership time to live value expires.  "),(0,r.mdx)("li",{parentName:"ul"},"The POI does not have the entered state flag set when calling the ",(0,r.mdx)("a",{parentName:"li",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#getnearbypointsofinterest"},(0,r.mdx)("inlineCode",{parentName:"a"},"getNearbyPointsOfInterest"))," API.  ")),(0,r.mdx)("p",null,"Even with a correct geofence and Places API implementation, device operating systems may not provide geofence exit signals for various reasons, which can impact the final Places state."),(0,r.mdx)("h3",{id:"last-entered-poi"},"Last entered POI"),(0,r.mdx)("p",null,"The last entered POI represents the POI that was most recently entered, which is identified by receiving an entry signal. The expiration time for this value is determined by the ",(0,r.mdx)("a",{parentName:"p",href:"#membership-time-to-live"},"membership time to live"),".  "),(0,r.mdx)("h3",{id:"last-exited-poi"},"Last exited POI"),(0,r.mdx)("p",null,"The last exited POI represents the POI that was most recently exited, which is identified by receiving an exit signal. The expiration time for this value is determined by the ",(0,r.mdx)("a",{parentName:"p",href:"#membership-time-to-live"},"membership time to live"),".  "),(0,r.mdx)("h2",{id:"scenarios"},"Scenarios"),(0,r.mdx)("p",null,"These scenarios assume that Places has been implemented to receive geofence entry and exit events from the mobile device operating system. In all cases, a Places event and a Places XDM Edge event are dispatched for the signal and POI provided to the ",(0,r.mdx)("a",{parentName:"p",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processregionevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processRegionEvent"))," API on iOS or the ",(0,r.mdx)("a",{parentName:"p",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofence"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofence"))," and ",(0,r.mdx)("a",{parentName:"p",href:"/aep-mobile-sdkdocs/src/pages/solution/places/api-reference.md#processgeofenceevent"},(0,r.mdx)("inlineCode",{parentName:"a"},"processGeofenceEvent"))," APIs on Android."),(0,r.mdx)("p",null,"The bolded POIs under each state indicate when a state is updated due to the location event at each step."),(0,r.mdx)("h3",{id:"initial-app-state"},"Initial app state"),(0,r.mdx)("p",null,"The app starts in a clean state with no previous Places events or persistent storage values."),(0,r.mdx)("h3",{id:"scenario-non-intersecting-points"},"Scenario: Non-intersecting points"),(0,r.mdx)("h4",{id:"enter-poi-a"},"Enter POI A"),(0,r.mdx)("p",null,"The user has entered the radius for POI A:  "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Current POI")," is set to POI A.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Entered POI")," is set to POI A.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Exited POI")," remains unchanged as none.  ")),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/aep-mobile-sdkdocs/assets/abff1bd8a5182c39bba0ab624165cbf0/non-intersecting-enter-A.svg",alt:null})),(0,r.mdx)("h4",{id:"exit-poi-a"},"Exit POI A"),(0,r.mdx)("p",null,"The user has exited the radius for POI A:  "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Current POI")," is set to none.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Entered POI")," remains unchanged as POI A.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Exited POI")," is set to POI A.  ")),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/aep-mobile-sdkdocs/assets/4616081eb7e6f61d7c80c8766f7ba515/non-intersecting-exit-A.svg",alt:null})),(0,r.mdx)("h4",{id:"enter-poi-b"},"Enter POI B"),(0,r.mdx)("p",null,"The user has entered the radius for POI B:  "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Current POI")," is set to POI B.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Entered POI")," is set to POI B.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Exited POI")," remains unchanged as POI A.  ")),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/aep-mobile-sdkdocs/assets/4882248ee76efde18316aff70aa03c2b/non-intersecting-enter-B.svg",alt:null})),(0,r.mdx)("h3",{id:"scenario-intersecting-points"},"Scenario: Intersecting points"),(0,r.mdx)("h4",{id:"enter-poi-a-1"},"Enter POI A"),(0,r.mdx)("p",null,"The user has entered the radius for POI A:  "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Current POI")," is set to POI A.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Entered POI")," is set to POI A.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Exited POI")," remains unchanged as none.  ")),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/aep-mobile-sdkdocs/assets/7dbed0542fca53e502cc324f01dbc0ac/intersecting-enter-A.svg",alt:null})),(0,r.mdx)("h4",{id:"enter-poi-b-1"},"Enter POI B"),(0,r.mdx)("p",null,"The user has entered the radius for POI B:  "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Current POI")," remains unchanged as POI A.  ",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},"This illustrates how library rankings influence the Current POI when multiple POIs are entered. Although POI B was most recently entered, POI A remains the Current POI due to its higher library ranking. Refer to ",(0,r.mdx)("a",{parentName:"li",href:"#current-poi"},"Current POI")," for the complete list of criteria.  "))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Entered POI")," is set to POI B.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last Exited POI")," remains unchanged as none.  ")),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/aep-mobile-sdkdocs/assets/8f920338f75aaab6b8365097db33ecc8/intersecting-enter-B.svg",alt:null})),(0,r.mdx)("h4",{id:"exit-poi-a-1"},"Exit POI A"),(0,r.mdx)("p",null,"The user has exited the radius for POI A:  "),(0,r.mdx)("ul",null,(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Current POI")," is set to POI B.  ",(0,r.mdx)("ul",{parentName:"li"},(0,r.mdx)("li",{parentName:"ul"},"POI A is removed from the entered POIs list, while POI B remains. Notice that Current POI updates to POI B upon receiving an exit signal.  "))),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last entered POI")," remains unchanged and is set to POI B.  "),(0,r.mdx)("li",{parentName:"ul"},(0,r.mdx)("strong",{parentName:"li"},"Last exited POI")," is set to POI A.  ")),(0,r.mdx)("p",null,(0,r.mdx)("img",{parentName:"p",src:"/aep-mobile-sdkdocs/assets/0fc748d20c83cf28c2836d3789a703e1/intersecting-exit-A.svg",alt:null})))}p.isMDXComponent=!0}}]);
//# sourceMappingURL=component---src-pages-solution-places-behavior-reference-md-60348e86920c20537ebe.js.map